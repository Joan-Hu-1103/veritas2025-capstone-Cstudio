<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>赛博音乐混合器</title>
    <style>
        /* 赛博朋克基础样式 */
        :root {
            --neon-pink: #ff2a6d;
            --neon-blue: #05d9e8;
            --neon-purple: #d300c5;
            --dark-bg: #0d0221;
            --scanline: rgba(0, 255, 255, 0.05);
        }
        
        body {
            margin: 0;
            padding: 0;
            background-color: var(--dark-bg);
            display: flex;
            height: 100vh;
            font-family: 'Courier New', monospace;
            overflow: hidden;
            color: var(--neon-blue);
            position: relative;
        }
        
        /* CRT显示器效果 */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                transparent 0%,
                var(--scanline) 2px),
                repeating-linear-gradient(
                to bottom,
                var(--scanline),
                var(--scanline) 1px,
                transparent 3px,
                transparent 5px);
            pointer-events: none;
            z-index: 100;
        }
        
        body::after {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(
                circle at center,
                transparent 0%,
                rgba(5, 217, 232, 0.1) 100%);
            pointer-events: none;
            z-index: 99;
        }
        
        /* 左侧音乐列表 */
        .music-list-container {
            width: 30%;
            height: 100%;
            padding: 30px;
            box-sizing: border-box;
            border-right: 1px solid var(--neon-purple);
            overflow-y: auto;
        }
        
        .music-list-title {
            color: var(--neon-pink);
            font-size: 1.8rem;
            margin-bottom: 30px;
            text-transform: uppercase;
            letter-spacing: 3px;
            text-shadow: 0 0 10px var(--neon-pink);
            animation: textGlow 2s infinite alternate;
        }
        
        .music-item {
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid var(--neon-blue);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .music-item:hover {
            background: rgba(255, 42, 109, 0.1);
            transform: translateX(5px);
            box-shadow: 0 0 15px var(--neon-pink);
        }
        
        .music-item::before {
            content: ">";
            position: absolute;
            left: -20px;
            transition: all 0.3s;
            color: var(--neon-blue);
        }
        
        .music-item:hover::before {
            left: 5px;
        }
        
        .music-number {
            color: var(--neon-purple);
            margin-right: 10px;
        }
        
        /* 子项目样式 */
        .sub-item {
            padding: 10px;
            margin: 5px 0 5px 20px;
            border: 1px solid var(--neon-purple);
            border-radius: 3px;
            background: rgba(13, 2, 33, 0.5);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }
        
        .sub-item:hover {
            background: rgba(255, 42, 109, 0.1);
        }
        
        .select-btn {
            padding: 5px 10px;
            background: transparent;
            border: 1px solid var(--neon-blue);
            color: var(--neon-blue);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.8rem;
        }
        
        .select-btn:hover {
            background: var(--neon-blue);
            color: var(--dark-bg);
        }
        
        /* 右侧内容区 */
        .right-container {
            width: 70%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        /* 音乐盒区域 */
        .music-box-container {
            height: 70%;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        
        .music-box {
            position: relative;
            width: 550px;
            height: 400px;
            background: rgba(13, 2, 33, 0.8);
            border: 2px solid var(--neon-pink);
            border-radius: 5px;
            box-shadow: 0 0 20px var(--neon-pink),
                        0 0 40px var(--neon-purple),
                        inset 0 0 15px var(--neon-blue);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
            animation: flicker 8s infinite alternate;
        }
        
        /* 选择结果显示区 */
        .selection-display {
            width: 100%;
            height: 100%;
            overflow-y: auto;
            color: var(--neon-purple);
        }
        
        .selected-track {
            padding: 10px;
            margin: 5px 0;
            border-bottom: 1px solid var(--neon-purple);
        }
        
        /* 下载按钮 */
        .download-btn {
            margin-top: 20px;
            padding: 10px 20px;
            background: transparent;
            border: 1px solid var(--neon-pink);
            color: var(--neon-pink);
            cursor: pointer;
            transition: all 0.3s;
            display: none;
        }
        
        .download-btn:hover {
            background: var(--neon-pink);
            color: var(--dark-bg);
            box-shadow: 0 0 15px var(--neon-pink);
        }
        
        /* 简介区域 */
        .info-container {
            height: 40%;
            padding: 20px 40px;
            box-sizing: border-box;
            border-top: 1px solid var(--neon-blue);
            overflow-y: auto;
        }
        
        .info-title {
            color: var(--neon-blue);
            font-size: 1.5rem;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .info-content {
            color: var(--neon-purple);
            line-height: 1.6;
            font-size: 0.9rem;
        }
        
        /* 返回按钮 */
        .back-button {
            position: absolute;
            bottom: 30px;
            left: 15%;
            transform: translateX(-50%);
            padding: 10px 25px;
            background: transparent;
            border: 1px solid var(--neon-blue);
            color: var(--neon-blue);
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .back-button:hover {
            background: var(--neon-blue);
            color: var(--dark-bg);
            box-shadow: 0 0 15px var(--neon-blue);
        }
        
        /* 赛博朋克风格动画 */
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes flicker {
            0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% {
                box-shadow: 0 0 20px var(--neon-pink),
                            0 0 40px var(--neon-purple),
                            inset 0 0 15px var(--neon-blue);
            }
            20%, 24%, 55% {
                box-shadow: none;
            }
        }
        
        @keyframes glitch {
            0% { transform: rotate(0deg); }
            2% { transform: rotate(1deg); }
            4% { transform: rotate(-1deg); }
            6% { transform: rotate(1deg); }
            8% { transform: rotate(0deg); }
            100% { transform: rotate(0deg); }
        }
        
        @keyframes textGlow {
            from {
                text-shadow: 0 0 5px var(--neon-pink);
            }
            to {
                text-shadow: 0 0 10px var(--neon-pink),
                            0 0 20px var(--neon-purple);
            }
        }
        
        /* 二进制代码背景装饰 */
        .binary-code {
            position: absolute;
            color: rgba(5, 217, 232, 0.1);
            font-size: 0.8rem;
            z-index: 1;
            animation: scroll 50s linear infinite;
        }
        
        @keyframes scroll {
            from { transform: translateY(0); }
            to { transform: translateY(-100%); }
        }

        /* 音频播放器样式 */
        .audio-player {
            width: 100%;
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <!-- 二进制代码背景元素 -->
    <div class="binary-code" style="top:0; left:5%;">01001000 01101001 00100000 01000011 01111001 01100010 01100101 01110010 00100000 01000100 01100001 01101110 01100011 01100101 01110010</div>
    <div class="binary-code" style="top:15%; left:80%;">01000010 01100001 01101100 01101100 01100101 01110100 00100000 01001001 01101110 00100000 01010100 01101000 01100101 00100000 01000011 01111001 01100010 01100101 01110010 00100000 01010011 01110000 01100001 01100011 01100101</div>
    <div class="binary-code" style="top:30%; left:20%;">01000111 01101100 01101001 01110100 01100011 01101000 00100000 01000001 01100101 01110011 01110100 01101000 01100101 01110100 01101001 01100011 00100000 00110010 00110000 00110010 00110100</div>
    
    <!-- 左侧音乐列表 - 修改为ABC三组 -->
    <div class="music-list-container">
        <div class="music-list-title">MUSIC MIXER</div>
        
        <!-- A组 -->
        <div class="music-item" onclick="toggleSubItems('A')">
            <span class="music-number">A</span> 节奏组
            <div id="sub-items-A" class="sub-items-container" style="display: none;">
                <div class="sub-item">
                    A1 - 山间鸟鸣 <audio class="audio-player" src="songs/A山间鸟鸣.mp3" controls></audio>
                    <button class="select-btn" onclick="selectTrack('A', '1', event)">选择</button>
                </div>
                <div class="sub-item">
                    A2 - 机场大厅 <audio class="audio-player" src="songs/A机场大厅.mp3" controls></audio>
                    <button class="select-btn" onclick="selectTrack('A', '2', event)">选择</button>
                </div>
                <div class="sub-item">
                    A3 - 海浪 <audio class="audio-player" src="songs/A海浪.mp3" controls></audio>
                    <button class="select-btn" onclick="selectTrack('A', '3', event)">选择</button>
                </div>
                <div class="sub-item">
                    A4 - 雷雨天 <audio class="audio-player" src="songs/A雷雨天.mp3" controls></audio>
                    <button class="select-btn" onclick="selectTrack('A', '4', event)">选择</button>
                </div>
            </div>
        </div>
        
        <!-- B组 -->
        <div class="music-item" onclick="toggleSubItems('B')">
            <span class="music-number">B</span> 低音组
            <div id="sub-items-B" class="sub-items-container" style="display: none;">
                <div class="sub-item">
                    B1 - 心跳 <audio class="audio-player" src="songs/B心跳.mp3" controls></audio>
                    <button class="select-btn" onclick="selectTrack('B', '1', event)">选择</button>
                </div>
                <div class="sub-item">
                    B2 - 相机快门 <audio class="audio-player" src="songs/B相机快门.mp3" controls></audio>
                    <button class="select-btn" onclick="selectTrack('B', '2', event)">选择</button>
                </div>
                <div class="sub-item">
                    B3 - 雨滴 <audio class="audio-player" src="songs/B雨滴.mp3" controls></audio>
                    <button class="select-btn" onclick="selectTrack('B', '3', event)">选择</button>
                </div>
            </div>
        </div>
        
        <!-- C组 -->
        <div class="music-item" onclick="toggleSubItems('C')">
            <span class="music-number">C</span> 旋律组
            <div id="sub-items-C" class="sub-items-container" style="display: none;">
                <div class="sub-item">
                    C1 - 布谷鸟 <audio class="audio-player" src="songs/C布谷鸟.mp3" controls></audio>
                    <button class="select-btn" onclick="selectTrack('C', '1', event)">选择</button>
                </div>
                <div class="sub-item">
                    C2 - 收音机底噪 <audio class="audio-player" src="songs/C收音机底噪.mp3" controls></audio>
                    <button class="select-btn" onclick="selectTrack('C', '2', event)">选择</button>
                </div>
                <div class="sub-item">
                    C3 - 蝉鸣 <audio class="audio-player" src="songs/C蝉鸣.mp3" controls></audio>
                    <button class="select-btn" onclick="selectTrack('C', '3', event)">选择</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 右侧内容区 -->
    <div class="right-container">
        <!-- 音乐盒区域 -->
        <div class="music-box-container">
            <div class="music-box">
                <div class="selection-display" id="selection-display">
                    <div class="info-title">您的音乐组合</div>
                    <div id="selected-tracks-container"></div>
                    <button id="download-btn" class="download-btn" onclick="downloadMix()">下载混合音乐</button>
                </div>
            </div>
        </div>
        
        <!-- 简介区域 -->
        <div class="info-container">
            <div class="info-title">OUR MUSIC MIXER - 使用说明</div>
            <div class="info-content">
                > SYSTEM INITIALIZED: 2025.08。04<br>
                > LOCATION: Veritas 2025 Shanghai<br>
                > STATUS: ONLINE<br><br>
                
                欢迎使用赛博音乐混合器。请看以下的使用方法：<br>
                1. 从左侧选择3组音频元素，每组选择一个子项目。<br>
                2. 您必须选择每组（A组、B组、C组）的一个音频元素（子项目）<br>
                3. 系统将根据您的选择提供预设的完美混合版本。<br><br>
                
                NOTES: （1）点击“选择“两次就可以取消选中音频元素。<br>
                （2）如果您想要下载混合音乐，请点击“下载混合音乐”按钮。<br>
                （3）如果您想要试听各音频元素，请点击播放音乐的图标。<br>
                （4）如果您想要返回主页，请点击“返回主页”按钮。
            </div>
        </div>
    </div>
    
    <!-- 返回按钮 -->
    <button class="back-button" onclick="window.location.href='index.html'">Return to Mainframe</button>

    <script>
        // 预设组合映射表 (A2B1C3 -> combo10.mp3)
       const comboMap = {
        'A1B1C1': '01.mp3', 'A1B1C2': '02.mp3', 'A1B1C3': '03.mp3',
        'A1B2C1': '04.mp3', 'A1B2C2': '05.mp3', 'A1B2C3': '06.mp3',
        'A1B3C1': '07.mp3', 'A1B3C2': '08.mp3', 'A1B3C3': '09.mp3',
    
        'A2B1C1': '10.mp3', 'A2B1C2': '11.mp3', 'A2B1C3': '12.mp3',
        'A2B2C1': '13.mp3', 'A2B2C2': '14.mp3', 'A2B2C3': '15.mp3',
        'A2B3C1': '16.mp3', 'A2B3C2': '17.mp3', 'A2B3C3': '18.mp3',
        
        'A3B1C1': '19.mp3', 'A3B1C2': '20.mp3', 'A3B1C3': '21.mp3',
        'A3B2C1': '22.mp3', 'A3B2C2': '23.mp3', 'A3B2C3': '24.mp3',
        'A3B3C1': '25.mp3', 'A3B3C2': '26.mp3', 'A3B3C3': '27.mp3',
        
        'A4B1C1': '28.mp3', 'A4B1C2': '29.mp3', 'A4B1C3': '30.mp3',
        'A4B2C1': '31.mp3', 'A4B2C2': '32.mp3', 'A4B2C3': '33.mp3',
        'A4B3C1': '34.mp3', 'A4B3C2': '35.mp3', 'A4B3C3': '36.mp3'
            };

        // 用户当前选择
        const currentSelection = {
            A: null,
            B: null,
            C: null
        };

        // 切换子项目显示/隐藏
        function toggleSubItems(groupId) {
            const subItems = document.getElementById(`sub-items-${groupId}`);
            subItems.style.display = subItems.style.display === 'none' ? 'block' : 'none';
            
            // 关闭其他组别的子项目
            ['A', 'B', 'C'].forEach(group => {
                if (group !== groupId) {
                    document.getElementById(`sub-items-${group}`).style.display = 'none';
                }
            });
        }

        // 修改后的选择音轨函数（可取消选择）
        function selectTrack(group, num, event) {
         event.stopPropagation();
    
        // 如果点击的是已选中的项目，则取消选择
        if (currentSelection[group] === num) {
            currentSelection[group] = null;
        } else {
            currentSelection[group] = num;
        }
        
        updateSelectionDisplay();
        checkAllSelected();
        
        // 更新按钮文本
        updateButtonTexts();
    }

        // 更新选择结果显示
        function updateSelectionDisplay() {
            const container = document.getElementById('selected-tracks-container');
            container.innerHTML = '';
            
            for (const [group, trackNum] of Object.entries(currentSelection)) {
                if (trackNum) {
                    const trackElement = document.createElement('div');
                    trackElement.className = 'selected-track';
                    trackElement.textContent = `${group}组: 选项${trackNum}`;
                    container.appendChild(trackElement);
                }
            }
        }

        // 检查是否全部选择
        function checkAllSelected() {
            const allSelected = Object.values(currentSelection).every(track => track !== null);
            document.getElementById('download-btn').style.display = allSelected ? 'block' : 'none';
        }

        // 下载混合音乐
       // 更新下载函数
function downloadMix() {
    const combo = `A${currentSelection.A}B${currentSelection.B}C${currentSelection.C}`;
    const audioFile = comboMap[combo];
    
    // 使用正确的路径格式（注意复数形式）
    const filePath = `audios/combos/${audioFile}`;
    const fileName = `cyber-mix-${combo}.mp3`;
    
    // 调试输出
    console.log("尝试下载文件:", filePath);
    
    // 创建下载链接
    const a = document.createElement('a');
    a.href = filePath;
    a.download = fileName;
    
    // 添加错误处理
    a.onerror = () => {
        const container = document.getElementById('selected-tracks-container');
        const errorMsg = document.createElement('div');
        errorMsg.className = 'selected-track error';
        errorMsg.textContent = `文件路径 ${filePath} 不存在，请检查: 
        1. 文件是否在正确位置
        2. 文件名是否完全匹配
        3. 服务器是否配置正确`;
        container.appendChild(errorMsg);
    };
    
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
}
    </script>
</body>
</html>